#include <iostream>
#include <stdlib.h>

using namespace std;
void fifo();
void optimal();


int frames=3 , pages = 7 , squence = 22;
int* frameArray ;
int* squenceArray ;
//int squenceArray []={7,0,1,2,0,3,0,4,2,3,0,3,2,1,2,0,1,7,0,1};

int main()
{
    cout << "Enter no. of Frames   :  "; cin>>frames ;
    cout << "Enter no. of Pages    :  "; cin>>pages ;
    cout << "Enter no. of sequence :  "; cin>>squence ;


    /// initialize arrays -->>
    frameArray = new int[frames];
    for(int i=0;i<frames ; i++) frameArray[i]=99;



    squenceArray = new int[squence];
    for(int i=0;i<squence ; i++) squenceArray[i]= (rand()%pages);
    cout<<"frame array :"; for(int i=0; i<frames ; i++) cout<<frameArray[i]<<"  "; cout<<endl;
    cout<<"sequence array :"; for(int i=0;i<squence ; i++) cout<<squenceArray[i]<<"  "; cout<<"\n\n\n";
    optimal();
    //fifo();

    return 0;
}


///FiFo
void fifo(){
    int oldest=0 , missCount=0 , enter=0 , COUNTER=1 ,flag=0;
    do{

        for(int i=0;i<frames;i++){
            if(squenceArray[enter] == frameArray[i] ){
                    flag=1;
                    break;  // ifnum already exist continue
            }
        }
       if(flag==0){
            frameArray[oldest]=squenceArray[enter] ;
            oldest=(oldest+1)%frames;
            cout<<(COUNTER)<<"     "; for(int i=0;i<3;i++) cout<<frameArray[i]<<"  ";
            cout<<endl;
            missCount++;
        }

       else{
            cout<<(COUNTER)<<"     "<<endl;
        }

        COUNTER++;
        enter++;
        flag=0;
    }while(enter<squence);
    cout<<"miss count : "<<missCount<<endl;
}


///Optimal !
void optimal(){
    int enter=0,flag=0,farIndex=-1,farNum=99,missCount=0,COUNTER=1 , j , toremove;

    do{
        for(int i=0;i<frames;i++){
            if(squenceArray[enter] == frameArray[i] ){
                    flag=1;
                    break;  // ifnum already exist continue
            }
        }
        if(enter<frames && flag==0 ){
                frameArray[missCount]=squenceArray[enter];
                missCount++;
                cout<<(COUNTER)<<"     "; for(int i=0;i<3;i++) cout<<frameArray[i]<<"  ";
                cout<<endl;
        }

        else{
            if(flag==0){
                for(int i=0 ; i<frames ; i++){
                    int found = 0 ;
                    for( j=enter+1 ; j<squence ; j++){
                        //cout<<" i : "<<i<<"\t, j : "<<j<<"\t, farIndex : "<<farIndex<<endl;
                        if(frameArray[i]==squenceArray[j]){
                            found = 1 ;
                            if(j>farIndex){
                                farIndex = j;
                                //cout<<"\t  farIndexChanged";
                                farNum = squenceArray[j] ;
                                toremove = i ;
                            }
                            break ;
                        }
                    }
                    if(found == 0) {
                        toremove=i ;
                        //cout<<"\tNotFound !! \n";
                        break;
                    }
                }
            // at the end of the loop i have the index to be removed !!
            frameArray[toremove]=squenceArray[enter] ;
            cout<<(COUNTER)<<"     "; for(int i=0;i<3;i++) cout<<frameArray[i]<<"  ";
            cout<<endl;
            missCount++;
            }

            else{
                cout<<(COUNTER)<<"     "<<endl;
            }
        }
        enter++;
        COUNTER++;
        flag=0;
        farIndex = -1;

    }while(enter<squence);
    cout<<"miss count : "<<missCount<<endl<<endl;

}
